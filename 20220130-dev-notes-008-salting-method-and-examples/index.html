<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2072d913c063a542f3b5.css" id="gatsby-global-css">/*! modern-normalize | MIT License | https://github.com/sindresorhus/modern-normalize */html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}hr{height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{padding:0}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}</style><meta name="generator" content="Gatsby 2.28.1"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://meshkorea.github.io/20220130-dev-notes-008-salting-method-and-examples/" data-baseprotocol="https:" data-basehost="meshkorea.github.io"/><title data-react-helmet="true">Salting 기법 예제 코드:: MESH KOREA | VROONG 테크 블로그</title><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicon.png" sizes="1024x1024"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link data-react-helmet="true" rel="mask-icon" href="/mask-icon.svg" color="#1b3993"/><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"/><meta data-react-helmet="true" name="description" content="이 글에서는 salting 기법을 기본 버전, 심화 버전의 pyspark 코드로 보여드립니다. 데이터 엔지니어링 과정에서 두 개 이상의 데이터를 JOIN 할 때 특정 키(key…"/><meta data-react-helmet="true" name="keywords" content="Mesh Korea, 메쉬코리아, 블로그, 기술 블로그, tech blog, makers blog, DataScience,DataEngineering,Salting,ExampleCode,Pyspark"/><meta data-react-helmet="true" property="og:url" content="https://meshkorea.github.io/20220130-dev-notes-008-salting-method-and-examples/"/><meta data-react-helmet="true" property="og:title" content="Salting 기법 예제 코드
            :: MESH KOREA | VROONG 테크 블로그"/><meta data-react-helmet="true" property="og:description" content="이 글에서는 salting 기법을 기본 버전, 심화 버전의 pyspark 코드로 보여드립니다. 데이터 엔지니어링 과정에서 두 개 이상의 데이터를 JOIN 할 때 특정 키(key…"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:image" content="https://meshkorea.github.io/static/93049f3313f9c628f7f3cdc4d9a5a545/d8255/title.jpg"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#EFF0F5"/><link rel="apple-touch-icon" sizes="192x192" href="/android-icon-192x192.png"/><link rel="apple-touch-icon" sizes="384x384" href="/android-icon-384x384.png"/><link as="script" rel="preload" href="/webpack-runtime-f8d2cfb60cb2b8fa895f.js"/><link as="script" rel="preload" href="/framework-da68acf1b9295dbf7273.js"/><link as="script" rel="preload" href="/app-6d6a5027655005a92ce4.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/e0525e89-155dc6265164ef0cd881.js"/><link as="script" rel="preload" href="/commons-137533670d01b5c35386.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-826d2b9ff3a07b601cb2.js"/><link as="fetch" rel="preload" href="/page-data/20220130-dev-notes-008-salting-method-and-examples/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1963140206.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css x35p1m-StyledLayoutRoot">.css-x35p1m-StyledLayoutRoot{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;background:#fff;}</style><div class="css-x35p1m-StyledLayoutRoot e3awmat0"><style data-emotion="css-global qoovf3">@import url("https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap");html{box-sizing:border-box;}*,*::before,*::after{box-sizing:inherit;}html{font-size:16px!important;line-height:1.5!important;}body{width:100%;overflow-x:hidden;overflow-y:scroll;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",Arial,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;color:#4B5058;background-color:#EFF0F5;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;}a{color:#0971ce;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:focus{-webkit-text-decoration:none;text-decoration:none;}img{max-width:100%;object-fit:contain;}figure{margin:2rem 0;}figcaption{font-size:80%;}table{width:100%;margin-bottom:1rem;border:1px solid #f5f3f7;font-size:85%;border-collapse:collapse;}td,th{padding:0.25rem 0.5rem;border:1px solid #f5f3f7;}th{text-align:left;}tbody tr:nth-of-type(odd) td{background-color:#fbfafc;}tbody tr:nth-of-type(odd) tr{background-color:#fbfafc;}h1,h2,h3,h4,h5,h6{margin-top:1.414rem;margin-bottom:0.5rem;color:inherit;font-weight:700;line-height:1.2;text-rendering:optimizeLegibility;}h1{margin-top:0;font-size:2.441rem;}h2{font-size:1.953rem;}h3{font-size:1.563rem;}h4,h5,h6{font-size:1.25rem;}p{margin-top:0;margin-bottom:1rem;}strong{color:inherit;}ul,ol,dl{margin-top:0;margin-bottom:1rem;}dt{font-weight:bold;}dd{margin-bottom:0.5rem;}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid #f5f3f7;}blockquote{margin:0.8rem 0;padding:0.5rem 1rem;border-left:0.25rem solid #f5f3f7;}blockquote p:last-child{margin-bottom:0;}@media (min-width: 48em){blockquote{padding-right:5rem;padding-left:1.25rem;}}code[class*="language-"],pre[class*="language-"]{color:black;background:none;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}@media print{code[class*="language-"],pre[class*="language-"]{text-shadow:none;}}pre[class*="language-"]{padding:1em;margin:0.5em 0;overflow:auto;}:not(pre)>code[class*="language-"]{padding:0.1em;border-radius:0.3em;white-space:normal;}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray;}.token.punctuation{color:#999;}.namespace{opacity:0.7;}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905;}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690;}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#9a6e3a;background:hsla(0, 0%, 100%, 0.5);}.token.atrule,.token.attr-value,.token.keyword{color:#07a;}.token.function,.token.class-name{color:#dd4a68;}.token.regex,.token.important,.token.variable{color:#e90;}.token.important,.token.bold{font-weight:bold;}.token.italic{font-style:italic;}.token.entity{cursor:help;}</style><style data-emotion="css jaqxp9-SmallTitleBox">.css-jaqxp9-SmallTitleBox{z-index:105;position:fixed;top:0;left:0;right:0;margin:0;height:75px;padding-top:26px;font-size:1.125rem;font-weight:700;line-height:1.2;background-color:#EFF0F5;}@media (max-width: 38.125em){.css-jaqxp9-SmallTitleBox{height:44px;padding-top:0;left:50px;}}</style><div class="css-jaqxp9-SmallTitleBox e1obetcm3"><style data-emotion="css 1mfk7pj-SmallTitleContainer">.css-1mfk7pj-SmallTitleContainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-1mfk7pj-SmallTitleContainer >a{color:inherit;}</style><style data-emotion="css eduyk7-StyledContainer-SmallTitleContainer">.css-eduyk7-StyledContainer-SmallTitleContainer{margin-left:auto;margin-right:auto;width:auto;max-width:71.25rem;padding:0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-eduyk7-StyledContainer-SmallTitleContainer::before,.css-eduyk7-StyledContainer-SmallTitleContainer::after{content:"";display:table;}.css-eduyk7-StyledContainer-SmallTitleContainer::after{clear:both;}@media (max-width: 38.125em){.css-eduyk7-StyledContainer-SmallTitleContainer{padding-left:16px;padding-right:16px;}}.css-eduyk7-StyledContainer-SmallTitleContainer >a{color:inherit;}</style><div class="e1obetcm5 css-eduyk7-StyledContainer-SmallTitleContainer e1ig3f2t0"><a href="/"><style data-emotion="css 282isq-SmallTitle">.css-282isq-SmallTitle{padding-top:7px;font-size:inherit;color:#05cd82;cursor:pointer;-webkit-transition:color 0.5s ease-in;transition:color 0.5s ease-in;}.css-282isq-SmallTitle .link-text{color:#4B5058;opacity:1;-webkit-transition:opacity 0.5s ease-in;transition:opacity 0.5s ease-in;}.css-282isq-SmallTitle i{margin-right:10px;}@media (max-width: 38.125em){.css-282isq-SmallTitle{display:none;}}</style><h1 class="css-282isq-SmallTitle e1obetcm4"><span class="link-text"><style data-emotion="css 1anhml5-IconWrapper">.css-1anhml5-IconWrapper{position:relative;display:inline-block;line-height:16px;color:inherit;}.css-1anhml5-IconWrapper>svg{vertical-align:top;}.css-1anhml5-IconWrapper>svg{fill:currentColor;}</style><i class="css-1anhml5-IconWrapper e12rwrnm0" height="16" title="MESH KOREA | VROONG"><svg width="242" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 271.53 18"><path d="M199.71,6.65a2.59,2.59,0,1,0,0-5.17H187V16.76h5.17V10.31l6.45,6.45h3.66V13.1l-6.45-6.45Z" fill="#05cd82"></path><path d="M210.81.65a8.47,8.47,0,1,0,8.52,8.47A8.5,8.5,0,0,0,210.81.65Zm0,12.09a3.52,3.52,0,0,1-3.41-3.62,3.42,3.42,0,1,1,6.83,0A3.52,3.52,0,0,1,210.81,12.74Z" fill="#05cd82"></path><polygon points="177.23 9.8 173.81 1.48 167.89 1.48 174.8 16.76 179.5 16.76 186.58 1.48 180.66 1.48 177.23 9.8" fill="#05cd82"></polygon><path d="M228.52.65A8.47,8.47,0,1,0,237,9.12,8.5,8.5,0,0,0,228.52.65Zm0,12.09a3.52,3.52,0,0,1-3.42-3.62,3.42,3.42,0,1,1,6.83,0A3.52,3.52,0,0,1,228.52,12.74Z" fill="#05cd82"></path><path d="M271.12,7.62H263V11h3.37a3.23,3.23,0,0,1-3,1.72,3.5,3.5,0,0,1-2.58-1.09,3.59,3.59,0,0,1-1.06-2.6,3.65,3.65,0,0,1,1-2.59,3.26,3.26,0,0,1,2.46-1.08,3.31,3.31,0,0,1,1.68.45,3.18,3.18,0,0,1,.77.58l4.18-2.68a8.46,8.46,0,0,0-6.62-3.1,8.08,8.08,0,0,0-6,2.51,8.19,8.19,0,0,0-2.47,6,8.49,8.49,0,0,0,8.51,8.47,8.24,8.24,0,0,0,8-8.47A8.21,8.21,0,0,0,271.12,7.62Z" fill="#05cd82"></path><polygon points="248.69 8.8 242.96 1.48 237.94 1.48 237.94 16.76 243.12 16.76 243.12 9.44 248.85 16.76 253.86 16.76 253.86 1.48 248.69 1.48 248.69 8.8" fill="#05cd82"></polygon><path d="M106.37,6.3c0-3.17-2.19-4.77-5.45-4.77H94.58V16.67h3.19v-5.6h2.47l3.26,5.6h3.61l-3.65-6A4.29,4.29,0,0,0,106.37,6.3ZM101,8.36H97.75V4.42H101c1.38,0,2.34.59,2.34,2S102.37,8.36,101,8.36Z" fill="#0071ce"></path><polygon points="20.72 10.05 26.95 10.05 26.95 7.11 20.72 7.11 20.72 4.5 28.2 4.5 28.2 1.53 17.69 1.53 17.69 16.67 28.52 16.67 28.52 13.71 20.72 13.71 20.72 10.05" fill="#0071ce"></polygon><polygon points="53.94 7.33 47.73 7.33 47.73 1.53 44.71 1.53 44.71 16.67 47.73 16.67 47.73 10.31 53.94 10.31 53.94 16.67 56.97 16.67 56.97 1.53 53.94 1.53 53.94 7.33" fill="#0071ce"></polygon><path d="M85.36,1.17c-4,0-6.81,3-6.81,8S81.3,17,85.32,17s6.78-3,6.78-7.94S89.36,1.17,85.36,1.17Zm0,12.8c-2.15,0-3.65-1.78-3.65-4.89s1.43-4.85,3.58-4.85S88.94,6,88.94,9.12,87.51,14,85.36,14Z" fill="#0071ce"></path><polygon points="112.64 10.05 118.87 10.05 118.87 7.11 112.64 7.11 112.64 4.5 120.12 4.5 120.12 1.53 109.61 1.53 109.61 16.67 120.45 16.67 120.45 13.71 112.64 13.71 112.64 10.05" fill="#0071ce"></polygon><path d="M130.53,1.53h-2.94L121.8,16.67H125l1.19-3.37h5.54L133,16.67h3.33Zm-3.26,8.89,1-2.75c.31-.88.61-1.79.76-2.35.15.56.45,1.47.76,2.35l1,2.75Z" fill="#0071ce"></path><path d="M7.35,8.18,3.2,1.53H.25V16.67h3V10.6c0-1.25,0-2.42,0-3.51l0,0C4,8.14,4.55,9.25,5.25,10.31L7,13h.54l1.76-2.7c.69-1.06,1.43-2.17,2.08-3.24l0,0c0,1.09,0,2.26,0,3.51v6.07h3V1.53H11.5Z" fill="#0071ce"></path><path d="M37.13,7.5c-2.36-.55-3-1.15-3-2.09,0-.66.54-1.34,2.13-1.34A4.56,4.56,0,0,1,39.65,5.6L41.8,3.52a7.14,7.14,0,0,0-5.43-2.35C33.43,1.17,31,2.83,31,5.54c0,2.94,1.92,4.11,4.67,4.75S39,11.53,39,12.49c0,1.13-.83,1.62-2.6,1.62a4.8,4.8,0,0,1-3.81-1.71l-2.15,1.92A6.91,6.91,0,0,0,36.26,17c4.06,0,5.85-1.91,5.85-4.74C42.11,9,39.49,8.05,37.13,7.5Z" fill="#0071ce"></path><polygon points="78.14 1.53 74.1 1.53 69.07 7.89 69.07 1.53 66.04 1.53 66.04 16.65 69.07 16.65 69.07 9.82 74.48 16.65 74.48 16.65 78.49 16.65 72.23 8.74 78.14 1.53" fill="#0071ce"></polygon><rect x="152.04" y="1.53" width="1.14" height="15.22" fill="#3e3a39"></rect></svg></i>테크 블로그</span></h1></a><div style="flex:1"></div><style data-emotion="css 22578y-RecruitLinks">.css-22578y-RecruitLinks{font-size:1rem;text-align:right;color:#0971ce;}.css-22578y-RecruitLinks >a{display:inline-block;min-width:36px;height:36px;padding-top:6px;text-align:center;line-height:24px;border-radius:18px;-webkit-transition:color 0.3s,background 0.5s;transition:color 0.3s,background 0.5s;}.css-22578y-RecruitLinks >a:hover,.css-22578y-RecruitLinks >a:focus{color:#fff;-webkit-text-decoration:none;text-decoration:none;background:#0971ce;}@media (max-width: 38.125em){.css-22578y-RecruitLinks >a{color:#5B5E62;margin:4px 0;border-radius:5px;}.css-22578y-RecruitLinks >a:hover,.css-22578y-RecruitLinks >a:focus{color:#4B5058;background:#E2E4EB;}}</style><div class="css-22578y-RecruitLinks e1obetcm2"><a href="https://github.com/meshkorea" target="_blank"><style data-emotion="css g8nddb-IconWrapper">.css-g8nddb-IconWrapper{position:relative;display:inline-block;line-height:24px;color:inherit;}.css-g8nddb-IconWrapper>svg{vertical-align:top;}.css-g8nddb-IconWrapper>svg{fill:currentColor;}</style><i class="css-g8nddb-IconWrapper e12rwrnm0" height="24"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,0A12,12,0,0,0,8.21,23.39c.6.11.82-.26.82-.58s0-1,0-2c-3.34.72-4-1.61-4-1.61A3.21,3.21,0,0,0,3.64,17.4c-1.09-.74.08-.73.08-.73a2.55,2.55,0,0,1,1.84,1.24,2.56,2.56,0,0,0,3.49,1,2.59,2.59,0,0,1,.76-1.61C7.15,17,4.34,16,4.34,11.37A4.63,4.63,0,0,1,5.58,8.15,4.28,4.28,0,0,1,5.7,5s1-.33,3.3,1.23a11.18,11.18,0,0,1,6,0C17.3,4.65,18.3,5,18.3,5a4.28,4.28,0,0,1,.12,3.17,4.63,4.63,0,0,1,1.23,3.22c0,4.61-2.8,5.63-5.47,5.92A2.88,2.88,0,0,1,15,19.52c0,1.6,0,2.89,0,3.29s.21.69.82.58A12,12,0,0,0,12,0Z"></path></svg></i></a><style data-emotion="css 17ctmwo-RecruitLink">.css-17ctmwo-RecruitLink{margin-left:12px;padding-top:5px!important;padding-left:1.25rem;padding-right:1.25rem;font-weight:600;border:1px solid #0971ce;}@media (max-width: 38.125em){.css-17ctmwo-RecruitLink{margin-left:0.6rem;margin-right:-0.625rem;padding-left:0.625rem;padding-right:0.625rem;line-height:26px;font-weight:400;color:#5B5E62;border:none;}}</style><a href="https://www.meshkorea.net/kr/career/" target="_blank" class="css-17ctmwo-RecruitLink e1obetcm1">지금 지원하러 가기</a></div></div></div><style data-emotion="css 1492abv-StyledHeader">.css-1492abv-StyledHeader{position:fixed;top:-125px;left:0;right:0;z-index:100;height:215px;padding:110px 0 0;color:#4B5058;border-bottom:1px solid #E2E4EB;background-color:#EFF0F5;}@media (max-width: 38.125em){.css-1492abv-StyledHeader{top:-51px;height:96px;padding-top:58px;-webkit-transition:height 0.3s;transition:height 0.3s;}}</style><header class="css-1492abv-StyledHeader e1obetcm9"><style data-emotion="css 2028mn-StyledContainer">.css-2028mn-StyledContainer{margin-left:auto;margin-right:auto;width:auto;max-width:71.25rem;padding:0 20px;}.css-2028mn-StyledContainer::before,.css-2028mn-StyledContainer::after{content:"";display:table;}.css-2028mn-StyledContainer::after{clear:both;}@media (max-width: 38.125em){.css-2028mn-StyledContainer{padding-left:16px;padding-right:16px;}}</style><div class="css-2028mn-StyledContainer e1ig3f2t0"><style data-emotion="css 1htaa58-LogoContainer">.css-1htaa58-LogoContainer{white-space:nowrap;overflow:hidden;}@media (min-width: 38.125em){.css-1htaa58-LogoContainer{display:none;}}</style><div class="css-1htaa58-LogoContainer e1obetcm8"><style data-emotion="css 93x8qt-HomepageLink">.css-93x8qt-HomepageLink{color:inherit;}.css-93x8qt-HomepageLink:hover,.css-93x8qt-HomepageLink:focus{-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-93x8qt-HomepageLink e1obetcm0" href="/"><style data-emotion="css l9mnzg-Logo">.css-l9mnzg-Logo{width:133px;height:24px;}@media (max-width: 38.125em){.css-l9mnzg-Logo{display:inline-block;width:26px;height:30px;overflow:hidden;color:#05cd82;}}</style><div class="css-l9mnzg-Logo e1obetcm7"><style data-emotion="css vi10os-IconWrapper">.css-vi10os-IconWrapper{position:relative;display:inline-block;line-height:18px;color:inherit;}.css-vi10os-IconWrapper>svg{vertical-align:top;}.css-vi10os-IconWrapper>svg{fill:currentColor;}</style><i class="css-vi10os-IconWrapper e12rwrnm0" height="18"><svg width="271.53" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 271.53 18"><path d="M199.71,6.65a2.59,2.59,0,1,0,0-5.17H187V16.76h5.17V10.31l6.45,6.45h3.66V13.1l-6.45-6.45Z" fill="#05cd82"></path><path d="M210.81.65a8.47,8.47,0,1,0,8.52,8.47A8.5,8.5,0,0,0,210.81.65Zm0,12.09a3.52,3.52,0,0,1-3.41-3.62,3.42,3.42,0,1,1,6.83,0A3.52,3.52,0,0,1,210.81,12.74Z" fill="#05cd82"></path><polygon points="177.23 9.8 173.81 1.48 167.89 1.48 174.8 16.76 179.5 16.76 186.58 1.48 180.66 1.48 177.23 9.8" fill="#05cd82"></polygon><path d="M228.52.65A8.47,8.47,0,1,0,237,9.12,8.5,8.5,0,0,0,228.52.65Zm0,12.09a3.52,3.52,0,0,1-3.42-3.62,3.42,3.42,0,1,1,6.83,0A3.52,3.52,0,0,1,228.52,12.74Z" fill="#05cd82"></path><path d="M271.12,7.62H263V11h3.37a3.23,3.23,0,0,1-3,1.72,3.5,3.5,0,0,1-2.58-1.09,3.59,3.59,0,0,1-1.06-2.6,3.65,3.65,0,0,1,1-2.59,3.26,3.26,0,0,1,2.46-1.08,3.31,3.31,0,0,1,1.68.45,3.18,3.18,0,0,1,.77.58l4.18-2.68a8.46,8.46,0,0,0-6.62-3.1,8.08,8.08,0,0,0-6,2.51,8.19,8.19,0,0,0-2.47,6,8.49,8.49,0,0,0,8.51,8.47,8.24,8.24,0,0,0,8-8.47A8.21,8.21,0,0,0,271.12,7.62Z" fill="#05cd82"></path><polygon points="248.69 8.8 242.96 1.48 237.94 1.48 237.94 16.76 243.12 16.76 243.12 9.44 248.85 16.76 253.86 16.76 253.86 1.48 248.69 1.48 248.69 8.8" fill="#05cd82"></polygon><path d="M106.37,6.3c0-3.17-2.19-4.77-5.45-4.77H94.58V16.67h3.19v-5.6h2.47l3.26,5.6h3.61l-3.65-6A4.29,4.29,0,0,0,106.37,6.3ZM101,8.36H97.75V4.42H101c1.38,0,2.34.59,2.34,2S102.37,8.36,101,8.36Z" fill="#0071ce"></path><polygon points="20.72 10.05 26.95 10.05 26.95 7.11 20.72 7.11 20.72 4.5 28.2 4.5 28.2 1.53 17.69 1.53 17.69 16.67 28.52 16.67 28.52 13.71 20.72 13.71 20.72 10.05" fill="#0071ce"></polygon><polygon points="53.94 7.33 47.73 7.33 47.73 1.53 44.71 1.53 44.71 16.67 47.73 16.67 47.73 10.31 53.94 10.31 53.94 16.67 56.97 16.67 56.97 1.53 53.94 1.53 53.94 7.33" fill="#0071ce"></polygon><path d="M85.36,1.17c-4,0-6.81,3-6.81,8S81.3,17,85.32,17s6.78-3,6.78-7.94S89.36,1.17,85.36,1.17Zm0,12.8c-2.15,0-3.65-1.78-3.65-4.89s1.43-4.85,3.58-4.85S88.94,6,88.94,9.12,87.51,14,85.36,14Z" fill="#0071ce"></path><polygon points="112.64 10.05 118.87 10.05 118.87 7.11 112.64 7.11 112.64 4.5 120.12 4.5 120.12 1.53 109.61 1.53 109.61 16.67 120.45 16.67 120.45 13.71 112.64 13.71 112.64 10.05" fill="#0071ce"></polygon><path d="M130.53,1.53h-2.94L121.8,16.67H125l1.19-3.37h5.54L133,16.67h3.33Zm-3.26,8.89,1-2.75c.31-.88.61-1.79.76-2.35.15.56.45,1.47.76,2.35l1,2.75Z" fill="#0071ce"></path><path d="M7.35,8.18,3.2,1.53H.25V16.67h3V10.6c0-1.25,0-2.42,0-3.51l0,0C4,8.14,4.55,9.25,5.25,10.31L7,13h.54l1.76-2.7c.69-1.06,1.43-2.17,2.08-3.24l0,0c0,1.09,0,2.26,0,3.51v6.07h3V1.53H11.5Z" fill="#0071ce"></path><path d="M37.13,7.5c-2.36-.55-3-1.15-3-2.09,0-.66.54-1.34,2.13-1.34A4.56,4.56,0,0,1,39.65,5.6L41.8,3.52a7.14,7.14,0,0,0-5.43-2.35C33.43,1.17,31,2.83,31,5.54c0,2.94,1.92,4.11,4.67,4.75S39,11.53,39,12.49c0,1.13-.83,1.62-2.6,1.62a4.8,4.8,0,0,1-3.81-1.71l-2.15,1.92A6.91,6.91,0,0,0,36.26,17c4.06,0,5.85-1.91,5.85-4.74C42.11,9,39.49,8.05,37.13,7.5Z" fill="#0071ce"></path><polygon points="78.14 1.53 74.1 1.53 69.07 7.89 69.07 1.53 66.04 1.53 66.04 16.65 69.07 16.65 69.07 9.82 74.48 16.65 74.48 16.65 78.49 16.65 72.23 8.74 78.14 1.53" fill="#0071ce"></polygon><rect x="152.04" y="1.53" width="1.14" height="15.22" fill="#3e3a39"></rect></svg></i></div><style data-emotion="css yek61y-Title">.css-yek61y-Title{font-size:3rem;margin:6px 0 0;font-weight:700;line-height:1.2;letter-spacing:-0.015em;}@media (max-width: 38.125em){.css-yek61y-Title{display:inline-block;margin:0 0 0 14px;font-size:1.125rem;line-height:30px;vertical-align:top;}}@media (max-width: 23.125em){.css-yek61y-Title{font-size:0.875rem;}}</style><h1 class="css-yek61y-Title e1obetcm6">테크 블로그</h1></a></div></div></header><style data-emotion="css 1gp6gx1-StyledLayoutMain">.css-1gp6gx1-StyledLayoutMain{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1;-ms-flex:1;flex:1;padding-top:90px;}@media (max-width: 38.125em){.css-1gp6gx1-StyledLayoutMain{padding-top:97px;}}</style><main class="css-1gp6gx1-StyledLayoutMain ewf609k0"><style data-emotion="css 1scz8kd-StyledPage">.css-1scz8kd-StyledPage{display:block;-webkit-flex:1;-ms-flex:1;flex:1;position:relative;padding:0;margin-bottom:3rem;}</style><div class="css-1scz8kd-StyledPage e9n6qsq0"><style data-emotion="css 1x25r3o-Wrapper">.css-1x25r3o-Wrapper{height:360px;font-size:1.125em;color:#fff;text-shadow:0 2px 4px rgba(0, 0, 0, 0.5);background-color:#7A7F86;-webkit-background-position:50% 50%;background-position:50% 50%;-webkit-background-size:cover;background-size:cover;background-image:url(/static/93049f3313f9c628f7f3cdc4d9a5a545/d8255/title.jpg);}</style><div style="background-position:50% 50%" class="css-1x25r3o-Wrapper e140x8tc2"><style data-emotion="css fqnm68-PostTitleContainer">.css-fqnm68-PostTitleContainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;height:100%;padding:0 90px 20px;}.css-fqnm68-PostTitleContainer >div span{margin-right:0.4em;cursor:pointer;opacity:0.75;-webkit-transition:opacity 0.5s;transition:opacity 0.5s;}.css-fqnm68-PostTitleContainer >div span:hover{opacity:1;}@media (min-width: 38.125em) and (max-width: 48em){.css-fqnm68-PostTitleContainer{padding-left:60px;padding-right:60px;}}@media (max-width: 38.125em){.css-fqnm68-PostTitleContainer{padding-left:56px;padding-right:56px;}}@media (min-width: 30em) and (max-width: 38.125em){.css-fqnm68-PostTitleContainer{padding-left:56px;padding-right:56px;}}@media (max-width: 30em){.css-fqnm68-PostTitleContainer{padding-left:16px;padding-right:16px;}}</style><style data-emotion="css bb5jcx-StyledContainer-PostTitleContainer">.css-bb5jcx-StyledContainer-PostTitleContainer{margin-left:auto;margin-right:auto;width:auto;max-width:71.25rem;padding:0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;height:100%;padding:0 90px 20px;}.css-bb5jcx-StyledContainer-PostTitleContainer::before,.css-bb5jcx-StyledContainer-PostTitleContainer::after{content:"";display:table;}.css-bb5jcx-StyledContainer-PostTitleContainer::after{clear:both;}@media (max-width: 38.125em){.css-bb5jcx-StyledContainer-PostTitleContainer{padding-left:16px;padding-right:16px;}}.css-bb5jcx-StyledContainer-PostTitleContainer >div span{margin-right:0.4em;cursor:pointer;opacity:0.75;-webkit-transition:opacity 0.5s;transition:opacity 0.5s;}.css-bb5jcx-StyledContainer-PostTitleContainer >div span:hover{opacity:1;}@media (min-width: 38.125em) and (max-width: 48em){.css-bb5jcx-StyledContainer-PostTitleContainer{padding-left:60px;padding-right:60px;}}@media (max-width: 38.125em){.css-bb5jcx-StyledContainer-PostTitleContainer{padding-left:56px;padding-right:56px;}}@media (min-width: 30em) and (max-width: 38.125em){.css-bb5jcx-StyledContainer-PostTitleContainer{padding-left:56px;padding-right:56px;}}@media (max-width: 30em){.css-bb5jcx-StyledContainer-PostTitleContainer{padding-left:16px;padding-right:16px;}}</style><div class="e140x8tc1 css-bb5jcx-StyledContainer-PostTitleContainer e1ig3f2t0"><style data-emotion="css 1g33qqm-PostTitle">.css-1g33qqm-PostTitle{font-size:2.5rem;margin:0;word-break:keep-all;}@media (max-width: 48em){.css-1g33qqm-PostTitle{font-size:2rem;}}</style><h1 class="css-1g33qqm-PostTitle e140x8tc0">Salting 기법 예제 코드</h1><div><style data-emotion="css 1muk9kd-StyledLink">.css-1muk9kd-StyledLink{display:inline-block;word-break:break-all;color:inherit;-webkit-transition:text-shadow 0.3s;transition:text-shadow 0.3s;}.css-1muk9kd-StyledLink:not(:last-of-type){margin-right:0.5em;}</style><a class="css-1muk9kd-StyledLink e1esqkvg0" href="/tags/DataScience">#<!-- -->DataScience</a><a class="css-1muk9kd-StyledLink e1esqkvg0" href="/tags/DataEngineering">#<!-- -->DataEngineering</a><a class="css-1muk9kd-StyledLink e1esqkvg0" href="/tags/Salting">#<!-- -->Salting</a><a class="css-1muk9kd-StyledLink e1esqkvg0" href="/tags/ExampleCode">#<!-- -->ExampleCode</a><a class="css-1muk9kd-StyledLink e1esqkvg0" href="/tags/Pyspark">#<!-- -->Pyspark</a></div></div></div><style data-emotion="css sz93qs-PostContainer">.css-sz93qs-PostContainer{position:relative;}</style><style data-emotion="css nokxz1-StyledContainer-PostContainer">.css-nokxz1-StyledContainer-PostContainer{margin-left:auto;margin-right:auto;width:auto;max-width:71.25rem;padding:0 20px;position:relative;}.css-nokxz1-StyledContainer-PostContainer::before,.css-nokxz1-StyledContainer-PostContainer::after{content:"";display:table;}.css-nokxz1-StyledContainer-PostContainer::after{clear:both;}@media (max-width: 38.125em){.css-nokxz1-StyledContainer-PostContainer{padding-left:16px;padding-right:16px;}}</style><div class="edaxc5g8 css-nokxz1-StyledContainer-PostContainer e1ig3f2t0"><style data-emotion="css m5nmoe-ShareSheet">.css-m5nmoe-ShareSheet{position:absolute;top:40px;right:50%;font-size:0.75rem;font-weight:500;text-align:right;color:#90959B;-webkit-transform:translateX(550px);-moz-transform:translateX(550px);-ms-transform:translateX(550px);transform:translateX(550px);}.css-m5nmoe-ShareSheet a,.css-m5nmoe-ShareSheet .SocialMediaShareButton{position:relative;display:block;margin-left:auto;margin-bottom:0.625rem;width:24px;color:#B9BDC1;cursor:pointer;-webkit-transition:color 0.5s;transition:color 0.5s;}.css-m5nmoe-ShareSheet a:hover,.css-m5nmoe-ShareSheet .SocialMediaShareButton:hover{color:#90959B;}.css-m5nmoe-ShareSheet a:focus,.css-m5nmoe-ShareSheet .SocialMediaShareButton:focus{outline:0;}.css-m5nmoe-ShareSheet a:hover::before{position:absolute;top:0.5rem;right:26px;width:0;height:0;content:attr(title);color:rgba(0, 0, 0, 0);overflow:hidden;border-left:4px solid rgba(0, 0, 0, 0.5);border-top:4px solid transparent;border-bottom:4px solid transparent;}.css-m5nmoe-ShareSheet a:hover::after{position:absolute;top:0.125rem;right:30px;content:attr(title);padding:0 10px;font-size:1.167em;white-space:nowrap;color:#fff;border-radius:5px;background:rgba(0, 0, 0, 0.5);}@media (max-width: 75em){.css-m5nmoe-ShareSheet{display:none;}}</style><aside class="css-m5nmoe-ShareSheet edaxc5g7"><style data-emotion="css 766jc8-ShareSheetTitles">.css-766jc8-ShareSheetTitles{margin:1rem 0 5px;font-size:1em;font-weight:inherit;}.css-766jc8-ShareSheetTitles:first-of-type{margin-top:0;}</style><h5 class="css-766jc8-ShareSheetTitles edaxc5g6">Share</h5><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--facebook"><i class="css-g8nddb-IconWrapper e12rwrnm0" height="24"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.68,0H1.32A1.32,1.32,0,0,0,0,1.32V22.67A1.33,1.33,0,0,0,1.32,24H12.83V14.72H9.7V11.08h3.13V8.41c0-3.1,1.89-4.79,4.66-4.79.93,0,1.86,0,2.79.14V7H18.37c-1.5,0-1.8.72-1.8,1.77v2.31h3.6l-.47,3.63H16.55V24h6.13A1.33,1.33,0,0,0,24,22.67h0V1.32A1.32,1.32,0,0,0,22.68,0Z"></path></svg></i></div><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--twitter"><i class="css-g8nddb-IconWrapper e12rwrnm0" height="24"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.89,21A12.84,12.84,0,0,0,20.82,8.07c0-.2,0-.39,0-.59a9.18,9.18,0,0,0,2.26-2.35,9.08,9.08,0,0,1-2.61.71,4.54,4.54,0,0,0,2-2.51,9.05,9.05,0,0,1-2.88,1.1,4.55,4.55,0,0,0-7.86,3.11,5.1,5.1,0,0,0,.11,1A12.9,12.9,0,0,1,2.47,3.83,4.54,4.54,0,0,0,3.87,9.9a4.59,4.59,0,0,1-2-.57v.06a4.54,4.54,0,0,0,3.64,4.45,4.7,4.7,0,0,1-1.2.16,4.8,4.8,0,0,1-.85-.08,4.54,4.54,0,0,0,4.24,3.15A9.09,9.09,0,0,1,2,19,9.51,9.51,0,0,1,.93,19a12.82,12.82,0,0,0,7,2"></path></svg></i></div></aside><style data-emotion="css 1sykmk4-AuthorInfo-PostAuthorInfo">.css-1sykmk4-AuthorInfo-PostAuthorInfo{margin-top:10px;margin-top:40px;}.css-1sykmk4-AuthorInfo-PostAuthorInfo::before,.css-1sykmk4-AuthorInfo-PostAuthorInfo::after{content:"";display:table;}.css-1sykmk4-AuthorInfo-PostAuthorInfo::after{clear:both;}@media (min-width: 30em) and (max-width: 48em){.css-1sykmk4-AuthorInfo-PostAuthorInfo{padding-left:40px;}}@media (max-width: 30em){.css-1sykmk4-AuthorInfo-PostAuthorInfo{padding-left:0;}}</style><aside class="css-1sykmk4-AuthorInfo-PostAuthorInfo edaxc5g3"><style data-emotion="css 1yyv0fh-AuthorAvatar-PostAuthorAvatar">.css-1yyv0fh-AuthorAvatar-PostAuthorAvatar{float:left;margin:0;width:3rem;height:3rem;border-radius:1.5rem;background-color:#EFF0F5;-webkit-background-position:50% 50%;background-position:50% 50%;-webkit-background-size:cover;background-size:cover;background-image:url(/static/9ed24df5bc4da5ffb8999eece711ff11/a2408/soonmok.kwon.png);}@media (max-width: 48em){.css-1yyv0fh-AuthorAvatar-PostAuthorAvatar{float:none;margin-bottom:0.75rem;width:2.25rem;height:2.25rem;}}</style><figure src="/static/9ed24df5bc4da5ffb8999eece711ff11/a2408/soonmok.kwon.png" class="css-1yyv0fh-AuthorAvatar-PostAuthorAvatar edaxc5g4"></figure><style data-emotion="css 1wratvv-AuthorName-PostAuthorName">.css-1wratvv-AuthorName-PostAuthorName{display:block;margin:4px 0 0 60px;font-weight:600;line-height:1.3;color:#4B5058;margin-top:2px;margin-left:70px;font-size:1.125rem;}@media (max-width: 48em){.css-1wratvv-AuthorName-PostAuthorName{margin-left:0;}}</style><strong class="css-1wratvv-AuthorName-PostAuthorName edaxc5g2">권순목</strong><style data-emotion="css 5vph4m-AuthorDesc-PostAuthorDesc">.css-5vph4m-AuthorDesc-PostAuthorDesc{margin-left:60px;font-size:0.875rem;color:#90959B;margin-left:70px;}@media (max-width: 48em){.css-5vph4m-AuthorDesc-PostAuthorDesc{margin-left:0;}}</style><aside class="css-5vph4m-AuthorDesc-PostAuthorDesc edaxc5g1">서비스개발본부 데이터사이언스실의 실장을 담당하고 있습니다.</aside><style data-emotion="css sja78i-AuthorDesc-PostAuthorDesc-PostDate">.css-sja78i-AuthorDesc-PostAuthorDesc-PostDate{margin-left:60px;font-size:0.875rem;color:#90959B;margin-left:70px;margin-top:1.125rem;margin-bottom:1.5rem;}@media (max-width: 48em){.css-sja78i-AuthorDesc-PostAuthorDesc-PostDate{margin-left:0;}}@media (max-width: 48em){.css-sja78i-AuthorDesc-PostAuthorDesc-PostDate{margin-top:0;}}</style><aside class="css-sja78i-AuthorDesc-PostAuthorDesc-PostDate edaxc5g0">2022-01-30</aside></aside><style data-emotion="css 1xa252c-PostWrapper">.css-1xa252c-PostWrapper{font-size:1.25rem;}@media (max-width: 48em){.css-1xa252c-PostWrapper{margin-left:0;}}@media (max-width: 38.125em){.css-1xa252c-PostWrapper{font-size:1.125rem;}}@media (max-width: 30em){.css-1xa252c-PostWrapper{font-size:1rem;}}</style><article id="article" class="css-1xa252c-PostWrapper edaxc5g9"><style data-emotion="css nlx8yd-TOCWrapper">.css-nlx8yd-TOCWrapper{color:#B9BDC1;-webkit-transition:color 0.5s;transition:color 0.5s;}.css-nlx8yd-TOCWrapper:hover{color:#7A7F86;}.css-nlx8yd-TOCWrapper >i{position:absolute;top:auto;margin-top:0.15em;width:30px;line-height:1.5rem;cursor:pointer;}.css-nlx8yd-TOCWrapper >i .short{-webkit-transition:width 0.5s;transition:width 0.5s;}.css-nlx8yd-TOCWrapper >i:hover .short{width:18px!important;}@media (max-width: 38.125em){.css-nlx8yd-TOCWrapper{display:none;}.css-nlx8yd-TOCWrapper >i{display:block;top:44px;left:0;margin-top:0;width:56px;height:50px;z-index:1100;padding:10px 36px 10px 16px;}}</style><nav class="css-nlx8yd-TOCWrapper e12xq6cv1"><i class="css-g8nddb-IconWrapper e12rwrnm0" height="24"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="2" rx="1" ry="1"></rect><rect class="short" x="3" y="17" width="13" height="2" rx="1" ry="1"></rect><rect class="short" x="3" y="5" width="13" height="2" rx="1" ry="1"></rect></svg></i><style data-emotion="css 1nabgxc-TOCList">.css-1nabgxc-TOCList{position:absolute;top:auto;margin-top:-10px;z-index:50;margin-left:30px;width:0;height:0;font-size:1rem;}.css-1nabgxc-TOCList ul{margin:0;padding:0;list-style:none;list-style-image:none;}.css-1nabgxc-TOCList ul p{margin:0;}.css-1nabgxc-TOCList ul a{display:block;margin-left:-0.5rem;margin-right:-0.5rem;padding:0.3rem 0.5rem;border-radius:0.5rem;-webkit-transition:background-color 0.5s;transition:background-color 0.5s;}.css-1nabgxc-TOCList ul a:hover{background-color:#EFF0F5;}.css-1nabgxc-TOCList ul:not(:first-of-type){padding-left:1rem;}.css-1nabgxc-TOCList >ul{visibility:hidden;opacity:0;-webkit-transition:visibility 0s 0.5s,opacity 0.5s;transition:visibility 0s 0.5s,opacity 0.5s;width:320px;max-height:360px;overflow-y:auto;padding:0.5rem 1rem;background:#fff;border-radius:10px;box-shadow:0px 2px 4px rgba(0, 0, 0, 0.5);}@media (max-width: 38.125em){.css-1nabgxc-TOCList{top:89px;left:0;right:0;margin-top:0;margin-left:0;width:100%;}.css-1nabgxc-TOCList >ul{width:100%;box-shadow:none;border-radius:0;border-bottom:1px solid #E2E4EB;}}</style><div class="css-1nabgxc-TOCList e12xq6cv0"><ul>
<li><a href="/20220130-dev-notes-008-salting-method-and-examples/#%EC%8F%A0%EB%A6%BC%EC%9D%B4-%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94-%EB%8D%B0%EC%9D%B4%ED%84%B0">쏠림이 발생하는 데이터</a></li>
<li><a href="/20220130-dev-notes-008-salting-method-and-examples/#%EC%9D%BC%EB%B0%98-join">일반 Join</a></li>
<li><a href="/20220130-dev-notes-008-salting-method-and-examples/#salting-join---%EA%B8%B0%EB%B3%B8-%EB%B2%84%EC%A0%84">Salting Join - 기본 버전</a></li>
<li><a href="/20220130-dev-notes-008-salting-method-and-examples/#salting-join---%EC%8B%AC%ED%99%94-%EB%B2%84%EC%A0%84">Salting Join - 심화 버전</a></li>
<li><a href="/20220130-dev-notes-008-salting-method-and-examples/#%EB%A7%BA%EC%9D%8C%EB%A7%90">맺음말</a></li>
</ul></div></nav><style data-emotion="css 2u5l10-Article">.css-2u5l10-Article{padding:0 70px;}.css-2u5l10-Article >*{margin:1.5em 0;}.css-2u5l10-Article .image-wrapper{margin-left:-70px;margin-right:-70px;text-align:center;}.css-2u5l10-Article .image-caption{margin-top:0.75em;font-size:0.833em;text-align:center;color:#7A7F86;}.css-2u5l10-Article >p{line-height:1.75;}.css-2u5l10-Article li>p,.css-2u5l10-Article li>ul{margin-bottom:0;}.css-2u5l10-Article pre,.css-2u5l10-Article code,.css-2u5l10-Article kbd,.css-2u5l10-Article samp{padding:0.125em 0.3125em;white-space:pre-wrap;font-size:0.889rem;background:#F7F8FC;border-radius:3px;}.css-2u5l10-Article p>code,.css-2u5l10-Article li>code{vertical-align:1px;word-break:break-word;}.css-2u5l10-Article pre{padding-top:0.5em;padding-bottom:0.5em;}.css-2u5l10-Article pre code{background:none;padding:0;}.css-2u5l10-Article a:hover,.css-2u5l10-Article a:active{-webkit-text-decoration:underline;text-decoration:underline;}.css-2u5l10-Article a.anchor{margin-left:-1.5rem;padding-right:0.5rem;line-height:1.1;color:#90959B;}.css-2u5l10-Article a.anchor >svg{fill:#90959B;}.css-2u5l10-Article .embedVideo-iframe{border:0;}@media (min-width: 30em) and (max-width: 48em){.css-2u5l10-Article{padding-left:40px;padding-right:40px;}.css-2u5l10-Article .gatsby-resp-iframe-wrapper,.css-2u5l10-Article .gatsby-resp-image-wrapper,.css-2u5l10-Article .image-wrapper{margin-left:-60px!important;margin-right:-60px!important;}}@media (min-width: 30em) and (max-width: 38.125em){.css-2u5l10-Article .gatsby-resp-iframe-wrapper,.css-2u5l10-Article .gatsby-resp-image-wrapper,.css-2u5l10-Article .image-wrapper{margin-left:-56px!important;margin-right:-56px!important;}}@media (max-width: 30em){.css-2u5l10-Article{padding-left:0;padding-right:0;}.css-2u5l10-Article .gatsby-resp-iframe-wrapper,.css-2u5l10-Article .gatsby-resp-image-wrapper,.css-2u5l10-Article .image-wrapper{margin-left:-16px!important;margin-right:-16px!important;}}</style><article class="css-2u5l10-Article edaxc5g5"><blockquote>
<p>이 글에서는 salting 기법을 기본 버전, 심화 버전의 pyspark 코드로 보여드립니다.</p>
</blockquote>
<p>데이터 엔지니어링 과정에서 두 개 이상의 데이터를 JOIN 할 때 특정 키(key)에 데이터가 집중되는 경우가
발생할 수 있습니다. 이런 것을 데이터 쏠림(skew)이라 합니다. 데이터 쏠림은 분산 처리의 효율을 떨어뜨리거나,
데이터 파이프라인 장애를 일으키는 주 원인중 하나로 알려져 있습니다.</p>
<p>Salting은 데이터 쏠림에 대한 대응책으로 자주 쓰이는 데이터 엔지니어링 기법입니다. salting이라는 용어는
말 그대로 소금뿌리기 정도로 이해하시면 좋습니다. 실제 구현을 보면 왜 그런지 이해가 가실 것입니다.
이 글에서는 salting 기법을 기본 버전, 심화 버전의 pyspark 코드로 보여드립니다.
spark의 직관적인 API 덕분에 salting의 실제 구현 방식을 쉽게 확인하실 수 있으실 것입니다.
물론, salting 기법은 MapReduce에서도 동일한 방식으로 활용할 수 있습니다.</p>
<h3 id="쏠림이-발생하는-데이터"><a href="#%EC%8F%A0%EB%A6%BC%EC%9D%B4-%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94-%EB%8D%B0%EC%9D%B4%ED%84%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>쏠림이 발생하는 데이터</h3>
<p>서울에서 전국 달리기 대회를 개최했습니다. 총 190 여명의 선수가 참가했으며, 다음과 같은 선수 데이터가 만들어 졌습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 600px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 53.06122448979592%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADhklEQVQozwF7A4T8ALjUpvuasor5wN2t973dqfi62Kj5nbWN+aO8k/a/3qz3v96r+rTPoviVrIb2psCW98Hervm72qf5wN2t+cDdrfaet472vdqq9MHerv+52aTAALLRnj2jwo47j6h/Tpa4gFG43KI9m7iIP26CYlqCnXFbueCfQZizh0Vkd1hfeY9qVLnboz6q0JFHt9iiPXuSbVxne1tgeI5pXLnZpD6kzYk8AP///wCuAP8AAAAAExdFABf///8AAAAAAQAAACAAFwAfE5YABgAAAAEAAAAhAAAAEP///wAxhwAN////AAAAAB8AAAAmAAAAI////wBJlRYQAHy0Vw6X32kNN1AnIVWAOSaU22YPa5xKEic5HC4+XCosiMtcFV2HQhMiMhg6MkojJpLXZQ54tVEcfLVXDyg6HDMkNRk2JzobM3uzVw53tE8bAGmiQQuJ1VYLLEQbHU14MSOI01YMV4Y2ECM2FiQ1UyEpg8tSEjxdJhQgMhQtJzwYJHe5Sw1xrkcZaKJBDCEzFSwcKxEzHzATMHCtRgtvrEYZAGihQgWk/mgFHSwSFVF/MxqU5l4HUXwzCRAZCiQqQRoljttZDCxEHAwRGwsuFSENIo3ZWQZ0tEkTWIc3BxglDyEUHwwmFyQOI2GWPQVysEgUAGunRQ+EzVQOM1AhIVWFNiSAyFIQYJU9EyI2FjA5WCQueb1NF2GXPhEhNBU4OFckIITNVA9ysUgcYZY+EiI2FjYjNxY0JToYMmunRA9xr0cbAF2TPQWs/28EFyQPF0lyLhyT5l4GVYU3Bw8XCiMpPxoljNpYDCc9GQwUHw0lFyQPHH3DUAd0tEoSSXIvBxIcCykSHAsnFCANJFeJOQVxr0cUAGqiQQ2R3loLKT8ZI0pyLieN2lgNWYk3ER4uEi8wSh4xgcdQE054MBIaKRA9KD0YJ4bPVA1uqkUbf8JOCy9IHSIfMBMzMUweIXy+TQtvq0UaAHCuRwiCy1MJOlslEVyPOhyAyFELY5o/CzFMHxRIby0cdrdKEmumRAksRRwbRm0sEIHJUgpwr0cXjdtZB0hwLhAtRhwaUoA0D4jUVwdvrUYYAG6pRQlvrEYLaqNDCm2pRRNuqkUMc7JJCpPkXQdqpEMQbalFEXS0Sgl+w1AJdLNJCm6rRgxxr0gTa6ZECnq9TQpzskkKeLlMCmynRApvrUYTpcw3ykKPxaAAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 1"
        title=""
        src="/static/77709d36004dca8b8e5323c0511434c7/ff59c/table1.png"
        srcset="/static/77709d36004dca8b8e5323c0511434c7/232f7/table1.png 245w,
/static/77709d36004dca8b8e5323c0511434c7/9319d/table1.png 490w,
/static/77709d36004dca8b8e5323c0511434c7/ff59c/table1.png 600w"
        sizes="(max-width: 600px) 100vw, 600px"
      />
    </span>
  </span>
  </p>
<p>아무래도 서울에서 개최된 경기이다보니, 서울 근처에서 가장 많이들 참가하였습니다. 지역별 참가자 수는 다음과 같습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 300px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 161.22448979591837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 2"
        title=""
        src="/static/a7095d5ea798b470bc82139c479a7bc1/f2d49/table2.png"
        srcset="/static/a7095d5ea798b470bc82139c479a7bc1/232f7/table2.png 245w,
/static/a7095d5ea798b470bc82139c479a7bc1/f2d49/table2.png 300w"
        sizes="(max-width: 300px) 100vw, 300px"
      />
    </span>
  </span>
  </p>
<p>모종의 데이터 분석을 위해, 여기에 각 지역의 평균 연령 데이터를 Join한다고 가정해 봅시다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 300px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 160.81632653061223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 3"
        title=""
        src="/static/ffb40274ac1f1e62a7b23e97a9b2e44f/f2d49/table3.png"
        srcset="/static/ffb40274ac1f1e62a7b23e97a9b2e44f/232f7/table3.png 245w,
/static/ffb40274ac1f1e62a7b23e97a9b2e44f/f2d49/table3.png 300w"
        sizes="(max-width: 300px) 100vw, 300px"
      />
    </span>
  </span>
  </p>
<h3 id="일반-join"><a href="#%EC%9D%BC%EB%B0%98-join" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일반 Join</h3>
<p>우선 salting 없이 그냥 JOIN하려면 다음과 같이 하면 됩니다. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">joined_1 <span class="token operator">=</span> runner<span class="token punctuation">.</span>join<span class="token punctuation">(</span>city<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'city'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span></code></pre></div>
<p>코드에서 선수 데이터와 광역단체 데이터는, 각각 spark DataFrame <code class="language-text">runner</code>와 <code class="language-text">city</code>에 해당합니다.
이 코드는 대부분의 시스템에서 문제없이 돌아갈 것이나, 동작 과정을 분석해보면 데이터 쏠림으로 인해
대부분의 spark 파티션(partition)이 5개 이하의 데이터만 처리하는 동안에, 두 개 파티션이 대부분이 데이터를
처리하게 됩니다. spark UI를 통해 데이터 분산 처리 내역을 다음과 같이 확인할 수 있습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 980px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 50.61224489795918%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2klEQVQoz42S3Y7bIBCF/f7v0/tKvWyrrlTFbFZrJ46T+Cc2BoMNDAxTQTe92KuOdKzBxh/nAEVzvcGvnz/wfKpxlBq5VNhNHNl7jc2lRSFE1rquyDlHpdSnXqK11htjyFp7KH4/DH5rNyonS6fFUL8FOgtLlxUIIv1vYXrEGMviPC7hNGmSm40UMS6cR8QQjdnjpnVCRudcFEJEKWUMIUREjELIKCWPxrzHVY2olCZELItpHAKYncZhiFprut1uZJ2jYRioqqoUg4QQdLlcaJom+hvNUFXV1DRfiU8vNLffcZ44OWfLYtv34AASKO77TgCQrNOyLBmYFlFKZWiqEDwZA3S/M1r4GwEQRdshBiTvfVkIIYJzjrquy8Bt2yiEQJxzquv6H3Ce5/RDXvAJ5Pyax+B7BMjfymJd1wzs+z4DkxAxA58O13XN4/T+6bDvjjTPAwFICv4FASIBuAwE5xx2XYf7vmelmucZq6pCrXW+HuM4ojHmQx7vtxLFckAPJXpofQJ6gEOR4nw4pM8On5HTNqS+aZp8WOmg0nytjhTCnPcxRweoCinlwTnH2rZl27ZlISJ7PB7s9fWVKaWyjscjq+uadV3HrLXser2yZdHM+8gA3CHBAODLH+XW9+JubNJSAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="일반 JOIN 동작 과정"
        title=""
        src="/static/27a84036bd6ff48617b8cec0cd4e2e25/2b72d/join1.png"
        srcset="/static/27a84036bd6ff48617b8cec0cd4e2e25/232f7/join1.png 245w,
/static/27a84036bd6ff48617b8cec0cd4e2e25/9319d/join1.png 490w,
/static/27a84036bd6ff48617b8cec0cd4e2e25/2b72d/join1.png 980w,
/static/27a84036bd6ff48617b8cec0cd4e2e25/814a3/join1.png 1470w,
/static/27a84036bd6ff48617b8cec0cd4e2e25/de62a/join1.png 1828w"
        sizes="(max-width: 980px) 100vw, 980px"
      />
    </span>
  </span>
  </p>
<p>이렇게 되는 이유는 선수들이 서울과 경기도에 몰려 있고 <code class="language-text">city</code>를 key로 JOIN 할 경우 서울이나 경기도를
처리하는 JOIN 파티션에 이 데이터들이 전부 몰려가기 때문입니다.</p>
<p>현재 예로 사용중인 데이터는 작은 크기이기 때문에, 각 파티션이 동작하는 시간에는 거의 차이가 느껴지지 않습니다만,
데이터의 규모가 커지거나 각 데이터에 대한 계산 과정이 복잡해진다면, 이 정도의 쏠림은 충분히 문제가 됩니다.
데이터가 많이 모이는 파티션의 처리 시간은 전체 실행 시간의 bottleneck이 되며,
심하면 메모리 문제로 해당 파티션이 죽음으로써, 전체 앱이 실패할 수 도 있습니다.</p>
<h3 id="salting-join---기본-버전"><a href="#salting-join---%EA%B8%B0%EB%B3%B8-%EB%B2%84%EC%A0%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Salting Join - 기본 버전</h3>
<p>이제 salting 기법을 이용해 데이터 쏠림을 완화해 보겠습니다. 우선 간단한 버전의 코드는 다음과 같습니다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">salt_size <span class="token operator">=</span> <span class="token number">10</span>

runner_2 <span class="token operator">=</span> runner<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">"salt"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>F<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> salt_size<span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span>T<span class="token punctuation">.</span>IntegerType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

@F<span class="token punctuation">.</span>udf<span class="token punctuation">(</span>T<span class="token punctuation">.</span>ArrayType<span class="token punctuation">(</span>T<span class="token punctuation">.</span>IntegerType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">salt_array_udf</span><span class="token punctuation">(</span>salt_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> salt_size<span class="token punctuation">)</span><span class="token punctuation">)</span>

city_2 <span class="token operator">=</span> city<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">"salt"</span><span class="token punctuation">,</span> F<span class="token punctuation">.</span>explode<span class="token punctuation">(</span>salt_array_udf<span class="token punctuation">(</span>F<span class="token punctuation">.</span>lit<span class="token punctuation">(</span>salt_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

joined_2 <span class="token operator">=</span> runner_2<span class="token punctuation">.</span>join<span class="token punctuation">(</span>city_2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">,</span> <span class="token string">'salt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span></code></pre></div>
<p>이 코드는 다음과 같은 일을 합니다.</p>
<ol>
<li>소금 크기(<code class="language-text">salt_size</code>)라는 변수를 정의합니다.</li>
<li><code class="language-text">runner</code> 데이터에 소금(<code class="language-text">salt</code>) 열(column)을 추가합니다. 이 열의 값은 0과 9사이의 랜덤 정수값입니다.</li>
<li><code class="language-text">city</code> 데이터에 소금(<code class="language-text">salt</code>) 열을 추가합니다. 이 열의 값은 0에서 9까지 모든 정수 값입니다.
즉, 기존 데이터의 1개 행을 10개 행으로 복제하고, 각각 값이 0 ~ 9인 소금 열을 추가해 줍니다.
이 과정에서 0 ~ 9값을 가지는 array 를 생성해주는 함수(<code class="language-text">salt_array_udf</code>)를 활용합니다.</li>
<li>소금(<code class="language-text">salt</code>) 열이 추가된 두 개 데이터를 JOIN 하는데, key로는 <code class="language-text">city</code>, <code class="language-text">salt</code> 둘 다 사용합니다.</li>
</ol>
<p>소금 열이 추가된 선수 데이터 <code class="language-text">runner_2</code>는 다음과 같은 형태입니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 700px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 56.326530612244895%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADhklEQVQozwF7A4T8ALzbqOafuJDrttOk6b/eq+umv5XqoLmR6brYp+nA36zroruT6Zmxiui51qfrvNup68PhsOqwzJ/oqMOY6MTisem+3Krrs8+h66S9lOu826jnAKPOhziTsYAtb4leSaLKhzeYuIQuYXZUR3eTZUe245kxb4ZgPlZpSVCpzZIuqNOLNpKwfzhbb09TWW1NUoijdzuq1Y41o8mKMZKvfzCEqG1EAFqnJhMZdAAGGDcEIEyWGREeYwAJCRkAJxw7BiFq1yALDCcAFg4hAScumAAGWq0iEQgvABEHFgAwCRoALQAcABRYrx4PR50NCwtTAAc5axcdAH69VBRnjkwHLkQfIni0URJTdTwLFyIRKT1bKh2a5WgNIjAZGhsnEylTeDsOjNJdET5YLBEYIxEtGSUSLC1AIRSGyVoQf7xXDFZ3QAlRejYfAHW2ShZSgTQKNFEhIHGxSBRSgDQMGysRJj5hJx2Cy1MQHjATIBknEDA6WyUViNNVEjdXIxQYJg8xGigQLypCGxd6v00Sb65HD057MgtRfjMgAHe5TBlekTsMNVMiJXGvRxZlnUANHzATLTVSISmU5F0QKD4ZIBwsEjZWhjcSgslRFT9hKBcdLhMzHzAUMTNOIBp8wU4VdbVKEVOBNQ5OeTElAHS1ShhajjkLNVMiI2+uRxZWhzYOHS4SKzdWIyWM21kQLEUcGyAyFCx8w08Ld7pLFjteJhYaKRA1HCsRMy5IHRp6v00Ub69HEFKBNA1RfjMiAHm7TRVYhzgJNFEhH3e4TBJUgjYLGScQKDpaJR+W518OJTkYGR0tEihglD0MgMZREztbJhIYJg8uGigQLSxDHBV/xVARdLRKDlmJOQlXiDcdAHW2ShRRgTMHKD8ZI2mkQhNYizgIFiMOJDJPICCO3VoNGSgQHBQgDS46WyURiNNVEDBMHhITHwwwFSINLSI2FRV8wk4QbqxFDUt2MAhTgjQcAHa3SxlglD0MNlQiJG+sRhdlnEANITMVKT1eJiON2lkRLkgdGyAyFC55vE0MebxMFkFmKRYfMBMwIDIULzRRIRh6vk0VdLVKEVOANA5OejElAHOySRlxr0cLaqRDE26rRRd0tEkMfsRQC2ynRBRysUgVca9HDHKxSA1xr0cOb6tFGHq9TQx9wU8MebxMDX/FUAturEYXca9HEWynRAtqpUMak9YhJgPNZfYAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 4"
        title=""
        src="/static/dd4c98e1dba4c0a1e96852199eec9dcd/39600/table4.png"
        srcset="/static/dd4c98e1dba4c0a1e96852199eec9dcd/232f7/table4.png 245w,
/static/dd4c98e1dba4c0a1e96852199eec9dcd/9319d/table4.png 490w,
/static/dd4c98e1dba4c0a1e96852199eec9dcd/39600/table4.png 700w"
        sizes="(max-width: 700px) 100vw, 700px"
      />
    </span>
  </span>
  </p>
<p>소금 열이 추가된 지역데이터 <code class="language-text">city_2</code> 는 다음과 같은 형태입니다. 각 행이 10개씩 복제되어 데이터 크기가 10배로 커졌습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 400px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 95.10204081632654%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFNklEQVQ4y3XT609TZxwH8OfFMnp6Tu/X01qgaGlpaYtSpICjaM9zeuMmzoibGKdgFM45QNHCoFwWp87bvLDMZFPZVKQ9p4JclFUMFy/Z3izOJep0c2PL/oS9WDaXsxwgW7ZsL355nuR5nuSXz+/7gPSz4V/vLo7xU48u/3bx1snf57+//nL+xXX+9vNr/J3nSf7C1En+yuwg/9Hkcf7q7OAfC4vXX6afDfPCnfSTa/z5G+/xEw8/4Rd+GBXefAduPh2KT3893HsueWiw92zb4ND0+6fSj0e6bz4d6p95PtJ9fuxo58dTJ7o+nTkT+4A7fGR4fvDE1ONLA/MvRmPpJyNdF2+d6rz56HLszjfJ+PD9s90AdAARAOAVAEAeAMAKAMjieR6ACMgQ1ntD34Jf5ngwfeoRAACoAQAmUA4Q4Uyon0Z5wP+8vAd5wADemdtuIHd61Zl2XYnJpinOLTK5tkb9iv50vaF/qkHRP7YL7UntkHz4VZs4f4M5xxPKtb89/rrx3P0O8ZF0k2RgfBd2fG4f1pfYg751xm8GB6fD2b49NpPZo9mUU6TxWTfovZWdBXh0PJhNJQk9zUEllSDU3bNVCrvf6C6ozCyiWWhuGyUVNAfVNAtVB2+FlVsPr9dWda11gc7bEb0zaFJpc6TFmhxJkcEmd5ftzJVFJ0L6lgQho1MQ2XfVj57+8U2RyaVabSnR5TMpEm8bD4ooDqIUC8XxezXIxr15EqLZYQOdMxHcHc7U4lZZiT5XVmxyKd2+3VZFx2QIpxKE0AXakvBjvfdrxGaPxmIrx11UgjC2jwcQmiUwiiWwrpkIGom5paGoyyZ0qLX5cIUqEytSmtBCvUVm99SZJR2TIW3LCCGhOZjRPOxHjj/dlmG0K7IspTorzUJddCL4Ks1ChEoSop6FalFFo00cirpWLxvu/m9DOknomWVDlWDo2GR0F0RWDMcCCmbFMPZZRLllwKMLRV1rQUwwDKwYmqWCoausYcVwBMpojkT2XfGjpxd3LBmuEQw5Em+7ERRRLIlSSSiO361FKprsEv9+R96yYcik1efKvEuGTqW7/G9DOZ2CKJXwY30PasTmQrVg6KSShLF9IoDQHMSoJCH4ohVNNrl/v92xbFhukP+fIcORK4b1/zIMLRnSLBTFpiOi2nihqG7AkwVi/zQsFwyr/jKEeoYjlXQCqnpmq5cM11ZmFTEsNLePBhQMS6oZFqo605XKzX2FumCrUzAM612hJUOvJkey3pAnGFpk0YmgvmWEkNEcgey/ugk9vfiGyORSCjl0MimIt90gRTRLoFSSEPc9qEF8u63SjXvz7KDrTiXuJE063Cr34lZ5kcmpLKhozFsxhAqGC6BUAmJ9DzaLzYUai81ncAo5jE6EEZojMZolsfhCLUo058uJZocD9CxUazNdKi1uldvUWRK30a6wrKvOlh6YCq/kUDAkkGNP6jOMDkWmpVSfy3BQ1z4uGJIIlYCi/s/rMkq2WzBI5VtA91xVZkEky2Ip1ZWYPZry3DK9N9DqNHRMhrKoBKET/nLLCKHqvVsjt76Gr8uHq0oYjsxuHQ3IhQwK1TEZUu44U6qu6/c4QHQqiBdvWy21+40Gmw83rN+aow4fdKNtYwE9lYRSmiNFLUko7pypRAprzUpv/ZpVNAvx1rFABs1BMcVCpH0iJN52zIs0nC0zAZoljANf1IrffbgFa7rkkx36cgt2YDqEMRw0MCmoZFJQwqSgVKj4vWqs8aJPJQyFSUGMSQnBh9L28YC04VyZrPGCz/gnXPwFstd5EIoAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 5"
        title=""
        src="/static/86ac8f13599606661a1e8aa06e91fd8b/6a8a8/table5.png"
        srcset="/static/86ac8f13599606661a1e8aa06e91fd8b/232f7/table5.png 245w,
/static/86ac8f13599606661a1e8aa06e91fd8b/6a8a8/table5.png 400w"
        sizes="(max-width: 400px) 100vw, 400px"
      />
    </span>
  </span>
  </p>
<p>spark UI를 통해 JOIN 과정을 살펴보면, 데이터 쏠림이 상당히 완화된 것을 확인할 수 있습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 980px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 72.24489795918367%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACAUlEQVQ4y42S627bMAxG/f6Ptb9rgXUL1jbItfHd8iW2JCuUrG+gHG9pFgwTQMi05YNDUlHbNPTt+Ss+Xl+8khLGjOi6FmmS4P3tDUKIEMMwoK7rEFJKVFWF8/mMruuglIIxJkS0aUb6su/wlCq/KiTexYi10PhZSBwaDedcCO89eE3T9CkH/DUQ3kUH0dMqH/DRau+8Rz8MGM0FbvJQWmNZl8slmLEFL96lHCClgdImVMBnojRNaNQKTS08H+JSz+cOo9bYbDbo+x7WWiRJEqJt22CYZRm22x3SdAVRHpHFaWhB1LYtuWlCmqaeDUZjgrrWGvv9PvzIwDzPQUShZM6F6JAk32HMGt6sMak+VBXVdU1XA8/a3GDOF2BRFCHnfRzHALXWQYgSWfYMrS2s7UBUgmhC1DQNcQm3QM4XIJsthtwSfrZ2Qi1iJMkPKEVwVsJSMQO7rvsncDG8BzbNAXG8gVIjnLvABkP6f0MGz0CaDesdTqcDlNIhn0s2cw8ZwEO5B+52uwclz0AhtgHI52agmIGLYZ7nYcp8YAEej0eUZRly3vme/S65PiBNN9DawDmevIC1N8B7Q95vDfn6sOE85QlVdUIcv4SLzd+Jks8lL4aPesj5nx7a67WpkGVPV8MzLMWw1s+GV4O/DB9NeTYklGWNOF5Bq1c4uwWRBJHFL54DL+u2hDUsAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="일반 JOIN 동작 과정"
        title=""
        src="/static/15cf33bed48e38cde128623e23a5d519/2b72d/join2.png"
        srcset="/static/15cf33bed48e38cde128623e23a5d519/232f7/join2.png 245w,
/static/15cf33bed48e38cde128623e23a5d519/9319d/join2.png 490w,
/static/15cf33bed48e38cde128623e23a5d519/2b72d/join2.png 980w,
/static/15cf33bed48e38cde128623e23a5d519/814a3/join2.png 1470w,
/static/15cf33bed48e38cde128623e23a5d519/aa454/join2.png 1496w"
        sizes="(max-width: 980px) 100vw, 980px"
      />
    </span>
  </span>
  </p>
<p>salting을 한마디로 말하면, 새로운 join key를 추가하여 데이터를 더 잘개 쪼개주는 것입니다.
그 새로운 join key가 소위 소금(<code class="language-text">salt</code>)이며, 데이터를 얼마나 잘게 더 쪼갤지를 결정하는 것이
소금의 크기(<code class="language-text">salt_size</code>)입니다.</p>
<p>salting은 마냥 좋기만 한 것은 아닙니다. 데이터가 쏠리는 파티션들이 줄어드는 대신,
한쪽의 데이터가 소금의 크기 만큼 복제되어야 하기 때문에, 그만큼의 네트워크 및 메모리 추가 소모를 일으킵니다.
이 때문에, <code class="language-text">salt_size</code>를 적정한 수준으로 결정할 필요가 있습니다.</p>
<blockquote>
<p>salting을 한마디로 말하면, 새로운 join key를 추가하여 데이터를 더 잘개 쪼개주는 것입니다.</p>
</blockquote>
<h3 id="salting-join---심화-버전"><a href="#salting-join---%EC%8B%AC%ED%99%94-%EB%B2%84%EC%A0%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Salting Join - 심화 버전</h3>
<p>앞에서, 적절한 <code class="language-text">salt_size</code>를 설정함으로서 salting은 꽤 효과적으로 동작할 수 있음을 앞에서 확인하였습니다만,
실무에서 이 적절한 소금 크기를 결정하는 것이 만만치 않은 경우도 있습니다.
예를 들어, 복제되어야 하는 쪽의 데이터가 매우 클 경우, 아무리 작은 <code class="language-text">salt_size</code>라도 부담스러울 수 있습니다. </p>
<p>이럴 때는 아예 <code class="language-text">salt_size</code>를 데이터에 맞춰 동적으로 설정함으로써 데이터 복제 부하를 최소화 할 수도 있습니다.
이런 과정까지를 포함한 심화된 버전의 salting join 코드는 다음과 같습니다.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">aggregation_limit <span class="token operator">=</span> <span class="token number">10</span>

runner_count <span class="token operator">=</span> runner<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>F<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span> <span class="token operator">></span> aggregation_limit<span class="token punctuation">)</span>

@F<span class="token punctuation">.</span>udf<span class="token punctuation">(</span>T<span class="token punctuation">.</span>IntegerType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">salt_size_udf</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> count <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    
    div <span class="token operator">=</span> count <span class="token operator">//</span> aggregation_limit
    rem <span class="token operator">=</span> count <span class="token operator">%</span> aggregation_limit

    <span class="token keyword">if</span> rem <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> div
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> div <span class="token operator">+</span> <span class="token number">1</span>

runner_3 <span class="token operator">=</span> runner<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
    F<span class="token punctuation">.</span>broadcast<span class="token punctuation">(</span>runner_count<span class="token punctuation">)</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'city'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">'salt_size'</span><span class="token punctuation">,</span> salt_size_udf<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">"salt"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>F<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> F<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">'salt_size'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span>T<span class="token punctuation">.</span>IntegerType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

@F<span class="token punctuation">.</span>udf<span class="token punctuation">(</span>T<span class="token punctuation">.</span>ArrayType<span class="token punctuation">(</span>T<span class="token punctuation">.</span>IntegerType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">salt_array_udf</span><span class="token punctuation">(</span>salt_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> salt_size<span class="token punctuation">)</span><span class="token punctuation">)</span>

city_3 <span class="token operator">=</span> city<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
    F<span class="token punctuation">.</span>broadcast<span class="token punctuation">(</span>runner_count<span class="token punctuation">)</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'city'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">'salt_size'</span><span class="token punctuation">,</span> salt_size_udf<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span>
    <span class="token string">"salt"</span><span class="token punctuation">,</span> F<span class="token punctuation">.</span>explode<span class="token punctuation">(</span>salt_array_udf<span class="token punctuation">(</span><span class="token string">'salt_size'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

joined_3 <span class="token operator">=</span> runner_3<span class="token punctuation">.</span>join<span class="token punctuation">(</span>city_3<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">,</span> <span class="token string">'salt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span></code></pre></div>
<p>이 코드는 다음과 같은 일을 합니다.</p>
<ol>
<li>하나의 JOIN key에 모여드는 데이터의 크기(<code class="language-text">aggregation_limit</code>)를 정합니다.
여기서는 하나의 key 당 10명의 선수만 모여들게 하겠다는 의미가 됩니다.</li>
<li>지역별 선수 숫자를 계산하여 <code class="language-text">runner_count</code>에 담습니다.</li>
<li>지역별 선수 숫자에 따른 소금 크기를 계산해주는 함수(<code class="language-text">salt_size_udf</code>)를 정의합니다.
이 함수는 기본적으로 선수 숫자를 <code class="language-text">aggregation_limit</code>로 나눕니다.</li>
<li>선수 데이터에 지역별 선수 숫자 데이터(<code class="language-text">runner_count</code>)를 join하고,
그것을 이용해 각 선수별 소금 크기(<code class="language-text">salt_size</code>)를 계산한 후,
그 소금 크기를 이용해 소금(<code class="language-text">salt</code>) 열을 추가합니다.</li>
<li>지역 데이터에 지역별 선수 숫자 데이터(<code class="language-text">runner_count</code>)를 join하고,
그것을 이용해 각 지역별 소금 크기(<code class="language-text">salt_size</code>)를 계산한 후,
그 소금 크기를 이용해 소금(<code class="language-text">salt</code>) 열을 추가합니다.</li>
</ol>
<p>최종 join 결과에서 각 지역마다 적절한 <code class="language-text">salt_size</code> 가 사용된 것을 확인할 수 있습니다.</p>
<p>
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: -70px; margin-right: -70px; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 32.244897959183675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVQY0wHmARn+AJS2fj1cblFTd5BoSK3VkzSjwZAvn8OIOpa1gjONrnk/iKR2On+bbUOHpHU8cIdhRqzTkjWYtYYxfJhpSK7Rly6EoHI6lbd+O4+pfTF5lmZFACBMAhgAAwAqBBsAH0SmAgoAFAAEKmcAEQtVAAkeSwAWBS8AEBIzAB0PPQARBR0AHEOnAAoAIAAEG0IAGxOaAAUORAANLWwDEQAjAAYdQAUfAFiDOx4fLhYwPVkpIYXHWRNmlEcOXo0/HGeXRhJVfjkeRWYvGz9eKiVQdzYaNU4kJH+9VRR8tVcMX44/G3OpThBrn0kRaZ1GGFd/PRBDZCwnAGynRBMZJxAlQ2gqFX/EUBBVhDYKV4Y3F1eGNw5GbSwcOVckFzVSISI9XicYJDgXJHOzSRFglT0JRmwsHXGuRwxajDkOYJQ9FUZrLAw6WyUjAFiJOBYTHgwnM08gGX7DTw9TgTUIWIg4FlOBNQ1DaCobOFckFDBLHiI7XSYWIzcWIXu/Tg9OejIJOlslIH3CTwlKcy8QW405FUFlKgs4VyMiAFuPOhwrRBsqPmAnI3W3ShZknUASYJY9G2ScPxRWhzYdUX4zGkVsKyNPfTIcOlokJHGxSBdglj0TR28tJHi8TBFSgDQaYJY8G16TOxNIcC0kT5GIWAbAi6UAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Table 6"
        title=""
        src="/static/ac5773d69ba921b947a05df219c5b260/7842b/table6.png"
        srcset="/static/ac5773d69ba921b947a05df219c5b260/232f7/table6.png 245w,
/static/ac5773d69ba921b947a05df219c5b260/9319d/table6.png 490w,
/static/ac5773d69ba921b947a05df219c5b260/7842b/table6.png 800w"
        sizes="(max-width: 800px) 100vw, 800px"
      />
    </span>
  </span>
  </p>
<p>이 코드에서 두 가지만 추가로 언급하겠습니다.</p>
<p>첫번째로, <code class="language-text">runner_count</code>를 생성하는 코드 뒤에 달린 <code class="language-text">filter</code> 구문입니다.
이것은 지역별 선수 숫자 전체 데이터 에서 필요한 부분만 뽑아내서 크기를 줄임으로써,
뒤에 <code class="language-text">runner_3</code>과 <code class="language-text">city_3</code>에 join 될 때 broadcast join 방식이 가능하게 해 줍니다.
<code class="language-text">salt_size_udf</code>는 널(null, None)일 경우 소금 크기를 최소(1)로 리턴하는 점을 이용한 것입니다.
그런데, 이런 방법을 일반적으로 아무 데이터에서나 사용할 수 있을까요?
이렇게 필터링한다고 항상 broadcast를 해도 될만큼 데이터가 작아질 수 있을까요?
답은 거의 대부분 그렇다 입니다. 쏠림이 발생하는 데이터는 대부분 그 분포가 파레토 법칙(Pareto Principle)을
따르기 때문입니다. 적절한 수준의 <code class="language-text">aggregation_limit</code>가 주어질 경우,
key 카운팅 데이터는 원래 데이터 숫자 대비 로그스케일(Logscale)로 줄어들 수 있습니다.
개 수를 로그스케일로 줄여도 수백만이 되는 데이터는 현재 거의 없다고 봐도 무방합니다.</p>
<p>두번째로 언급할 것은 <code class="language-text">runner_count</code>가 꼭 정확할 필요가 없다는 것입니다.
대략적인 패턴만 유지된다면, 과거 데이터를 기반으로 미리 계산해 놓은 것을 써도 별 문제가 안됩니다.
데이터 파이프라인 상에서 자주 실행되는 앱(application)의 경우,
카운팅 과정만 따로 떼어내서 그 빈도를 낮춰줌으로써, 추가적인 최적화가 가능합니다.</p>
<h3 id="맺음말"><a href="#%EB%A7%BA%EC%9D%8C%EB%A7%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>맺음말</h3>
<p>이 글에서는 salting join 기법에 대해 살펴 보았습니다.
salting 기법은 데이터 쏠림이 발생하여 문제가 되는 상황을 해결하기 위한 기법으로, 기본적으로는
새로운 join key를 추가하여 데이터를 더 잘개 쪼개주는 것입니다. 이 새로운 join key를 소금(<code class="language-text">salt</code>)이라고 부르며,
일정 법위의 정수 값 입니다. 이 값을 어떤식으로 뿌려줄 것인가에 따라 다양한 최적화가 가능합니다.</p></article></article></div></div></main><style data-emotion="css 2jxy3p-Wrapper">.css-2jxy3p-Wrapper{padding-bottom:1.187rem;}</style><footer class="css-2jxy3p-Wrapper e1tbim063"><style data-emotion="css u2k6lz-FooterContainer">.css-u2k6lz-FooterContainer{border-top:1px solid #E2E4EB;padding-top:2.187rem;}</style><style data-emotion="css 1al4zm4-StyledContainer-FooterContainer">.css-1al4zm4-StyledContainer-FooterContainer{margin-left:auto;margin-right:auto;width:auto;max-width:71.25rem;padding:0 20px;border-top:1px solid #E2E4EB;padding-top:2.187rem;}.css-1al4zm4-StyledContainer-FooterContainer::before,.css-1al4zm4-StyledContainer-FooterContainer::after{content:"";display:table;}.css-1al4zm4-StyledContainer-FooterContainer::after{clear:both;}@media (max-width: 38.125em){.css-1al4zm4-StyledContainer-FooterContainer{padding-left:16px;padding-right:16px;}}</style><div class="e1tbim062 css-1al4zm4-StyledContainer-FooterContainer e1ig3f2t0"><style data-emotion="css 1gbez60-CompanyLogo">.css-1gbez60-CompanyLogo{float:left;width:160px;}@media (max-width: 48em){.css-1gbez60-CompanyLogo{float:none;width:auto;}}</style><div class="css-1gbez60-CompanyLogo e1tbim061"><style data-emotion="css 1636f4y-IconWrapper">.css-1636f4y-IconWrapper{position:relative;display:inline-block;line-height:16px;color:#0971ce;}.css-1636f4y-IconWrapper>svg{vertical-align:top;}.css-1636f4y-IconWrapper>svg{fill:#0971ce;}</style><i class="css-1636f4y-IconWrapper e12rwrnm0" height="16" color="#0971ce"><svg width="121.15" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 136.29 18"><path d="M106.37,6.3c0-3.17-2.19-4.77-5.45-4.77H94.58V16.67h3.19v-5.6h2.47l3.26,5.6h3.61l-3.65-6A4.29,4.29,0,0,0,106.37,6.3ZM101,8.36H97.75V4.42H101c1.38,0,2.34.59,2.34,2S102.37,8.36,101,8.36Z"></path><polygon points="20.72 10.05 26.95 10.05 26.95 7.11 20.72 7.11 20.72 4.5 28.2 4.5 28.2 1.53 17.69 1.53 17.69 16.67 28.52 16.67 28.52 13.71 20.72 13.71 20.72 10.05"></polygon><polygon points="53.94 7.33 47.73 7.33 47.73 1.53 44.71 1.53 44.71 16.67 47.73 16.67 47.73 10.31 53.94 10.31 53.94 16.67 56.97 16.67 56.97 1.53 53.94 1.53 53.94 7.33"></polygon><path d="M85.36,1.17c-4,0-6.81,3-6.81,8S81.3,17,85.32,17s6.78-3,6.78-7.94S89.36,1.17,85.36,1.17Zm0,12.8c-2.15,0-3.65-1.78-3.65-4.89s1.43-4.85,3.58-4.85S88.94,6,88.94,9.12,87.51,14,85.36,14Z"></path><polygon points="112.64 10.05 118.87 10.05 118.87 7.11 112.64 7.11 112.64 4.5 120.12 4.5 120.12 1.53 109.61 1.53 109.61 16.67 120.45 16.67 120.45 13.71 112.64 13.71 112.64 10.05"></polygon><path d="M130.53,1.53h-2.94L121.8,16.67H125l1.19-3.37h5.54L133,16.67h3.33Zm-3.26,8.89,1-2.75c.31-.88.61-1.79.76-2.35.15.56.45,1.47.76,2.35l1,2.75Z"></path><path d="M7.35,8.18,3.2,1.53H.25V16.67h3V10.6c0-1.25,0-2.42,0-3.51l0,0C4,8.14,4.55,9.25,5.25,10.31L7,13h.54l1.76-2.7c.69-1.06,1.43-2.17,2.08-3.24l0,0c0,1.09,0,2.26,0,3.51v6.07h3V1.53H11.5Z"></path><path d="M37.13,7.5c-2.36-.55-3-1.15-3-2.09,0-.66.54-1.34,2.13-1.34A4.56,4.56,0,0,1,39.65,5.6L41.8,3.52a7.14,7.14,0,0,0-5.43-2.35C33.43,1.17,31,2.83,31,5.54c0,2.94,1.92,4.11,4.67,4.75S39,11.53,39,12.49c0,1.13-.83,1.62-2.6,1.62a4.8,4.8,0,0,1-3.81-1.71l-2.15,1.92A6.91,6.91,0,0,0,36.26,17c4.06,0,5.85-1.91,5.85-4.74C42.11,9,39.49,8.05,37.13,7.5Z"></path><polygon points="78.14 1.53 74.1 1.53 69.07 7.89 69.07 1.53 66.04 1.53 66.04 16.65 69.07 16.65 69.07 9.82 74.48 16.65 74.48 16.65 78.49 16.65 72.23 8.74 78.14 1.53"></polygon></svg></i></div><style data-emotion="css dtdcvy-CompanyDesc">.css-dtdcvy-CompanyDesc{margin-left:160px;}@media (max-width: 48em){.css-dtdcvy-CompanyDesc{margin-left:0;margin-top:1.5rem;}}@media (max-width: 38.125em){.css-dtdcvy-CompanyDesc{font-size:0.875rem;}}</style><div class="css-dtdcvy-CompanyDesc e1tbim060"><p>프리미엄 배달대행 부릉을 운영하는 메쉬코리아는 투명하고 유연하게 라이더를 연결하는 물류플랫폼을 지향합니다.<br/>물류플랫폼을 함께 만들어갈 능력있는 사람들과 함께할 사람들을 찾습니다.</p><p><a href="https://www.meshkorea.net/kr/career/" target="_blank">지금 지원하러 가기 <i class="css-1anhml5-IconWrapper e12rwrnm0" height="16"><svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M12,8a1,1,0,0,1-.29.71l-5,5a1,1,0,0,1-1.42-1.42L9.59,8,5.29,3.71A1,1,0,0,1,6.71,2.29l5,5A1,1,0,0,1,12,8Z"></path></svg></i></a></p></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-71371143-19',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-71371143-19', 'auto', {});
      ga('set', 'anonymizeIp', true);
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/20220130-dev-notes-008-salting-method-and-examples/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-dfda8d059abd9d0298c4.js"],"app":["/app-6d6a5027655005a92ce4.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a784631a3269b148b831.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-2030ab2a53582eb4acec.js"],"component---src-templates-pages-tsx":["/component---src-templates-pages-tsx-faf52131eb81a2acc5f6.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-826d2b9ff3a07b601cb2.js"],"component---src-templates-tags-tsx":["/component---src-templates-tags-tsx-f9a749b633c17bb4de81.js"]};/*]]>*/</script><script src="/polyfill-dfda8d059abd9d0298c4.js" nomodule=""></script><script src="/component---src-templates-post-tsx-826d2b9ff3a07b601cb2.js" async=""></script><script src="/commons-137533670d01b5c35386.js" async=""></script><script src="/e0525e89-155dc6265164ef0cd881.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-6d6a5027655005a92ce4.js" async=""></script><script src="/framework-da68acf1b9295dbf7273.js" async=""></script><script src="/webpack-runtime-f8d2cfb60cb2b8fa895f.js" async=""></script></body></html>